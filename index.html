<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mortgage Calculator</title>
  <meta name="description" content="Responsive mortgage calculator with validation, breakdown, and Excel bulk testing." />
  <link rel="stylesheet" href="style.css" />
  <!-- SheetJS for reading Excel files -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js" defer></script>
  <script src="script.js" defer></script>
</head>
<body>
  <div class="container">
    <header class="header" aria-label="Header">
      <h1>Mortgage Calculator</h1>
      <p class="subtitle">Estimate monthly repayments. Upload Excel to test multiple scenarios.</p>
    </header>

    <main class="layout" aria-label="Main content">
      <!-- Left: Inputs -->
      <section class="panel" aria-label="Calculator inputs">
        <form id="form" novalidate>
          <div class="field">
            <label for="amount">Loan amount (£)</label>
            <input id="amount" name="amount" type="number" inputmode="decimal" placeholder="e.g. 200000" min="1" step="0.01" required />
            <small class="error" id="err-amount"></small>
          </div>

          <div class="field">
            <label for="rate">Interest rate (%)</label>
            <div class="rate-wrap">
              <input id="rate" name="rate" type="number" inputmode="decimal" placeholder="e.g. 3.5" min="0" step="0.01" required />
              <input id="rateRange" type="range" min="0" max="15" step="0.05" aria-label="Interest rate slider" />
            </div>
            <small class="hint">Type a rate or use the slider.</small>
            <small class="error" id="err-rate"></small>
          </div>

          <div class="field">
            <label for="years">Term (years)</label>
            <input id="years" name="years" type="number" inputmode="numeric" placeholder="e.g. 25" min="1" max="60" required />
            <small class="error" id="err-years"></small>
          </div>

          <div class="field">
            <label for="type">Mortgage type</label>
            <select id="type" name="type">
              <option value="repayment" selected>Repayment (capital + interest)</option>
              <option value="interest-only">Interest-only (illustrative)</option>
            </select>
            <small class="hint">Interest-only shows interest payments; principal is unchanged.</small>
          </div>

          <div class="options">
            <label class="check">
              <input type="checkbox" id="persist" checked />
              Remember my inputs on this device
            </label>
          </div>

          <div class="actions">
            <button type="submit" class="btn">Calculate</button>
            <button type="button" id="reset" class="btn btn-secondary">Reset</button>
          </div>

          <hr class="divider" />

          <div class="field">
            <label for="excelFile">Upload test data (Excel)</label>
            <input type="file" id="excelFile" accept=".xlsx,.xls" />
            <small class="hint">Expected columns: <strong>Amount</strong>, <strong>Rate</strong>, <strong>Years</strong>, optional <strong>Type</strong> (repayment or interest-only)</small>
          </div>
        </form>
      </section>

      <!-- Right: Results -->
      <section class="panel result-panel" aria-label="Results">
        <div id="resultDefault" class="result-placeholder">
          <p>Enter details and select Calculate to view results.</p>
        </div>

        <div id="results" class="results" hidden>
          <div class="cards">
            <div class="card">
              <h3>Monthly payment</h3>
              <p class="value" id="monthly">£0.00</p>
            </div>
            <div class="card">
              <h3>Total interest</h3>
              <p class="value" id="interest">£0.00</p>
            </div>
            <div class="card">
              <h3>Total repaid</h3>
              <p class="value" id="total">£0.00</p>
            </div>
          </div>

          <div class="breakdown">
            <h3>Breakdown (first 12 months)</h3>
            <div class="legend">
              <span class="chip principal">Principal</span>
              <span class="chip interest">Interest</span>
            </div>
            <table class="table" aria-label="First year breakdown">
              <thead>
                <tr>
                  <th>Month</th>
                  <th>Principal (£)</th>
                  <th>Interest (£)</th>
                  <th>Balance (£)</th>
                </tr>
              </thead>
              <tbody id="table"></tbody>
            </table>
          </div>

          <p class="note">
            Figures are estimates assuming a constant annual rate. For advice tailored to your situation, please consult a qualified adviser.
          </p>
        </div>
      </section>
    </main>

    <!-- Bulk test results (Excel) -->
    <section class="panel" aria-label="Bulk results via Excel">
      <h3>Bulk test results</h3>
      <table class="table">
        <thead>
          <tr>
            <th>#</th>
            <th>Amount (£)</th>
            <th>Rate (%)</th>
            <th>Years</th>
            <th>Type</th>
            <th>Monthly (£)</th>
          </tr>
        </thead>
        <tbody id="bulkTable"></tbody>
      </table>
    </section>

    <footer class="footer" aria-label="Footer">
      <p>© 2025 — Demo mortgage calculator for learning and testing.</p>
    </footer>
  </div>
</body>
</html>
